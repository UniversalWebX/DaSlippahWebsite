
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Da Slippah</title>
  <link href="https://fonts.googleapis.com/css2?family=Arimo:wght@400;700&family=League+Spartan:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="navbar">
    <div class="logo">Da Slippah</div>
    <ul class="nav-links">
      <li><a href="#home" class="nav-link active">Home</a></li>
      <li><a href="#movies" class="nav-link">Movies</a></li>
      <li><a href="#status" class="nav-link">Status</a></li>
      <li><a href="#soundtracks" class="nav-link">Soundtracks</a></li>
      <li><a href="#blog" class="nav-link">Blog</a></li>
      <li><a href="#userblog" class="nav-link">Userblog</a></li>
      <li><a href="#applications" class="nav-link">Apply</a></li>
    </ul>
    <div class="auth">
      <button class="auth-btn" onclick="openModal('login')">Login</button>
      <button class="auth-btn" onclick="openModal('register')">Sign Up</button>
      <span id="welcome" style="display:none;color:#00ff6e;margin-left:1rem"></span>
      <button id="logout" class="auth-btn" style="display:none" onclick="logout()">Logout</button>
    </div>
  </nav>

  <section id="home" class="section active">
    <div class="hero">
      <h1 class="title-glow">Da Slippah</h1>
      <p id="coming-soon">Da SLippah 2 â€¢ Coming 2026 <button onclick="this.parentElement.remove()">Ã—</button></p>
      <div class="hero-buttons">
        <a href="#movies" class="big-btn">Watch Movies</a>
        <a href="#applications" class="big-btn secondary">Applications</a>
        <a href="#status" class="big-btn secondary">Production Status</a>
      </div>
    </div>
  </section>

  <section id="movies" class="section">
    <h2 class="section-title">Movies</h2>
    <div class="movies-grid">
      <div class="movie-card">
        <div class="poster"><div class="gradient"></div><h3>Da Slippah 1</h3><span>2025</span></div>
        <div class="info"><h3>Da Slippah 1</h3>
          <button class="play-btn" onclick="watchMovie('movie1')">Watch Alone</button>
          <button class="play-btn together" onclick="watchTogether('movie1')">Watch Together</button>
          <div class="progress"><div id="p-movie1"></div></div>
          <div id="reviews-movie1"></div>
          <form class="review-form" onsubmit="submitReview('movie1', event)">
            <input type="number" placeholder="Rating (1-5)" min="1" max="5" required>
            <textarea placeholder="Comment" required></textarea>
            <button type="submit">Review</button>
          </form>
        </div>
      </div>

      <div class="memes-panel">
        <h3>Memes Edition</h3>
        <div class="scrollable">
          <div class="movie-card">
            <div class="poster memes"><div class="gradient memes"></div><h3>Memes Edition</h3><span>2025</span></div>
            <div class="info"><h3>Memes Edition</h3>
              <button class="play-btn" onclick="watchMovie('memes')">Watch Alone</button>
              <button class="play-btn together" onclick="watchTogether('memes')">Watch Together</button>
              <div class="progress"><div id="p-memes"></div></div>
              <div id="reviews-memes"></div>
              <form class="review-form" onsubmit="submitReview('memes', event)">
                <input type="number" placeholder="Rating (1-5)" min="1" max="5" required>
                <textarea placeholder="Comment" required></textarea>
                <button type="submit">Review</button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <div class="movie-card coming">
        <div class="poster sequel"><div class="gradient sequel"></div><h3>Da Slippah 2</h3><span>2026</span></div>
        <div class="info"><h3>Da Slippah 2</h3><p>Coming Soon</p></div>
      </div>
    </div>
  </section>

  <section id="status" class="section">
    <h2 class="section-title">Production Status</h2>
    <div class="status-grid">
      <div class="status-item">Filming in progress: ðŸ”´</div>
      <div class="status-item">Script percentage done: 10%</div>
      <div class="status-item">Actors acquired: 5%</div>
      <div class="status-item">Actors needed: 95% More</div>
    </div>
  </section>

  <section id="soundtracks" class="section">
    <h2 class="section-title">Soundtracks ðŸŽ¶</h2>
    <div class="soundtrack-list">
      <p>Rejectito - ft. Jasper</p>
      <p>Iâ€™m Really Screwed</p>
      <p>Grief and agony</p>
      <p>World Wars</p>
      <p>More coming soon!</p>
    </div>
  </section>

  <section id="blog" class="section">
    <h2 class="section-title">Blog</h2>
    <article class="blog-post">
      <h3>Scene One Recording and new blog posts!</h3>
      <p>This is the first post in the new Da Slippah blog thing we (darian) decided to create. Iâ€™ll try to post every week or so. News:</p>
      <ol>
        <li>Filming of scene one starting from Monday to Wednesday and to be done by the end of the week (hopefully)</li>
        <li>Website visual revamp coming soon!</li>
      </ol>
      <p>To apply for a role in the movie or to work on things like editing and making the sets, <a href="#applications">click here</a></p>
      <p><em>* Darian</em></p>
    </article>
  </section>

  <section id="userblog" class="section">
    <h2 class="section-title">Userblog</h2>
    <div id="posts"></div>
    <form id="post-form" class="review-form" style="display:none" onsubmit="submitPost(event)">
      <input placeholder="Title" required>
      <textarea placeholder="Content" required></textarea>
      <button type="submit">Post</button>
    </form>
  </section>

  <section id="applications" class="section">
    <h2 class="section-title">Applications</h2>
    <a href="https://forms.gle/tau7UAXefkZrJDt58" target="_blank" class="big-btn">Apply Now</a>
    </div>
  </section>

  <div id="auth-modal" class="modal"><div class="modal-content">
    <span class="close" onclick="closeModal('auth-modal')">Ã—</span>
    <h2 id="auth-title">Login</h2>
    <form id="auth-form" onsubmit="handleAuth(event)">
      <input id="username" placeholder="Username" style="display:none">
      <input type="email" placeholder="Email" required>
      <input type="password" placeholder="Password" required>
      <button type="submit">Submit</button>
    </form>
  </div></div>

  <div id="watch-modal" class="modal"><div class="modal-content wide">
    <span class="close" onclick="closeWatch()">Ã—</span>
    <iframe id="video" width="100%" height="500" frameborder="0" allow="autoplay"></iframe>
    <div class="chat-box">
      <div id="chat"></div>
      <input id="chat-input" placeholder="Say something...">
      <button onclick="sendChat()">Send</button>
    </div>
    <div id="room-users"></div>
  </div></div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    let user = null, token = null, socket = io(), roomId = null, video = null;

    function openModal(type) {
      document.getElementById('auth-modal').style.display = 'flex';
      document.getElementById('auth-title').textContent = type === 'login' ? 'Login' : 'Register';
      document.getElementById('username').style.display = type === 'register' ? 'block' : 'none';
    }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }

    async function handleAuth(e) {
      e.preventDefault();
      const form = e.target;
      const body = { email: form[1].value, password: form[2].value };
      if (form[0].style.display !== 'none') body.username = form[0].value;
      const url = document.getElementById('auth-title').textContent === 'Login' ? '/api/login' : '/api/register';
      const res = await fetch(url, { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(body) });
      const data = await res.json();
      if (res.ok) {
        user = data.user; token = data.token;
        document.getElementById('welcome').textContent = 'Hi ' + user.username;
        document.getElementById('welcome').style.display = 'inline';
        document.getElementById('logout').style.display = 'inline-block';
        document.querySelectorAll('.auth button').forEach(b => b.style.display = 'none');
        closeModal('auth-modal');
        document.getElementById('post-form').style.display = 'block';
        loadReviews('movie1');
        loadReviews('memes');
        loadPosts();
      } else alert(data.error);
    }

    function logout() { user = null; token = null; location.reload(); }

    function switchSection(id) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
      document.querySelector(id).classList.add('active');
      document.querySelector(`a[href="${id}"]`).classList.add('active');
    }

    document.querySelectorAll('.nav-link').forEach(link => {
      link.onclick = e => { e.preventDefault(); switchSection(link.getAttribute('href')); };
    });

    async function loadReviews(movie) {
      const res = await fetch(`/api/reviews/${movie}`);
      const data = await res.json();
      document.getElementById(`reviews-${movie}`).innerHTML = data.map(r => `<div class="review">${r.username}: ${r.rating}/5 - ${r.comment}</div>`).join('');
    }

    async function submitReview(movie, e) {
      e.preventDefault();
      const form = e.target;
      const body = { movieId: movie, username: user.username, rating: form[0].value, comment: form[1].value };
      await fetch('/api/reviews', { method: 'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(body) });
      loadReviews(movie);
      form.reset();
    }

    async function loadPosts() {
      const res = await fetch('/api/userblog');
      const data = await res.json();
      document.getElementById('posts').innerHTML = data.map(p => `<div class="blog-post"><h3>${p.title}</h3><p>${p.content}</p><p><em>${p.username} - ${p.date}</em></p></div>`).join('');
    }

    async function submitPost(e) {
      e.preventDefault();
      const form = e.target;
      const body = { username: user.username, title: form[0].value, content: form[1].value };
      await fetch('/api/userblog', { method: 'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(body) });
      loadPosts();
      form.reset();
    }

    function watchMovie(movie) {
      const urls = { movie1: "https://drive.google.com/file/d/1LyNZxP_bm2lVbnC6J9HPQn8hKbxlx0Al/preview", memes: "https://drive.google.com/file/d/1P4TUhjsUsp9rH-BxsAFK7UdLbvhhUgOL/preview" };
      document.getElementById('video').src = urls[movie];
      document.getElementById('watch-modal').style.display = 'flex';
    }

    function watchTogether(movie) {
      roomId = prompt("Enter room ID (or blank for new):") || Date.now().toString();
      socket.emit('join-room', { roomId, username: user ? user.username : "Guest" });
      watchMovie(movie);
    }

    function closeWatch() { document.getElementById('watch-modal').style.display = 'none'; document.getElementById('video').src = ''; }

    socket.on('video-sync', d => { document.getElementById('video').currentTime = d.time; if (d.playing) document.getElementById('video').play(); else document.getElementById('video').pause(); });
    socket.on('chat', d => { document.getElementById('chat').innerHTML += `<div>${d.username}: ${d.message}</div>`; });
    socket.on('room-users', u => { document.getElementById('room-users').textContent = 'Users: ' + u.join(', '); });

    function sendChat() {
      const input = document.getElementById('chat-input');
      if (input.value && roomId) {
        socket.emit('chat', { roomId, message: input.value });
        input.value = '';
      }
    }
  </script>
</body>
</html>



